# Orders Service

Микросервис для приёма и выдачи данных о заказах: HTTP-API, простая веб-страница для пользователя, Consumer из Kafka и хранение в БД.

## Содержание
- [Описание проекта](#описание-проекта)
- [Архитектура](#архитектура)
  - [Модули](#модули)
  - [Структура](#структура)
  - [API](#api)
- [Стек и зависимости](#стек-и-зависимости)
- [Конфигурация](#конфигурация)
- [Развертывание и запуск](#развертывание-и-запуск)
- [Тестирование](#тестирование)
- [Кэш](#кэш)
- [Схема БД](#схема-бд)
- [Миграции БД](#миграции-бд)
- [Обработка ошибок и ретраи](#обработка-ошибок-и-ретраи)

---

## Описание проекта

Сервис предоставляет:
- HTTP-API для получения информации о заказе: `GET /orders/{id}` (кэш -> БД).
- Простую HTML-страницу для ручного ввода `order_id` и просмотра данных.
- Consumer, который читает новые заказы из Kafka и сохраняет их в БД.
- Интеграционные тесты для проверки сквозной работы модулей.

---

## Архитектура

### Модули

#### HTTP-сервер
Обрабатывает запросы к API и отдаёт HTML для `/`.

#### Web UI
Статическая страница на `/` с формой поиска по `order_id`.

#### Consumer (Kafka -> DB)
Читает сообщения с заказами из Kafka и сохраняет/обновляет записи в БД.

#### PostgreSQL
Хранит информацию о заказах и связанных сущностях.

#### Тестовый модуль
Интеграционные тесты для проверки сценариев end-to-end.

### Структура
Будет добавлено позже.

### API

#### `GET /orders/{id}`
**Описание:** получить заказ по идентификатору.  
**Источник данных:** Cache -> DB (fallback).

**Ответы:**
- `200 OK` - JSON заказа
- `404 Not Found` - заказ не найден
- `500 Internal Server Error` - ошибка сервера

#### `GET /`
**Описание:** HTML-форма для ввода `order_id`.  
**Ответы:** `200 OK` - HTML.

---

## Стек и зависимости
- Язык: Go
- Брокер сообщений: Apache Kafka
- Хранилище: PostgreSQL
- Кэш: in-memory
- Контейнеризация: Docker + docker-compose
- Документация API: Swagger / OpenAPI *(будет добавлено позже)*
- Тестовые данные: gofakeit/faker *(будет интегрировано позже)*

---

## Конфигурация
Будет добавлено позже.

> Планируется приложить `.env.example` с ключевыми переменными окружения.

---

## Развертывание и запуск
Будет добавлено позже.

> Предполагается сценарий локального запуска через `docker compose up` и отдельные команды для модулей.

---

## Тестирование
Будет добавлено позже.

---

## Кэш
- **Стратегия:** Cache-Aside (read-through) - сначала кэш, при промахе запрос к БД и последующая запись в кэш.  
- **Ключ:** `order:{id}`.

---

## Схема БД
Будет добавлено позже.

> Запланировано: ER-диаграмма, ключи/индексы, ограничения целостности, примеры записей.

---

## Миграции БД
Будет добавлено позже.

> Сейчас используется стартовая миграция
---

## Обработка ошибок и ретраи
Будет добавлено позже.